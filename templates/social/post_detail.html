{% extends 'base.html' %}

{% block title %}–ü–æ—Å—Ç {{ post.author.username }} - MiniSocial{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-8">
        <div class="card">
            <div class="card-body">
                <div class="d-flex justify-content-between align-items-start">
                    <h6 class="card-subtitle mb-2">
                        <a href="{% url 'profile' post.author.username %}" class="text-decoration-none">
                            {{ post.author.username }}
                        </a>
                    </h6>
                    <small class="text-muted">{{ post.created_at|date:"d M Y H:i" }}</small>
                </div>
                
                <p class="card-text mt-3">{{ post.content|linebreaksbr }}</p>
                
                {% if post.image %}
                <div class="mt-3">
                    <img src="{{ post.image.url }}" class="img-fluid rounded" alt="Post image">
                </div>
                {% endif %}
                
                <div class="mt-3 d-flex justify-content-between">
                    <div>
                        <form method="post" action="{% url 'like_post' post.pk %}" class="d-inline">
                            {% csrf_token %}
                            <button type="submit" class="like-btn {% if user in post.likes.all %}liked{% endif %}">
                                ‚ù§Ô∏è {{ post.likes.count }}
                            </button>
                        </form>
                        <span class="ms-3">üí¨ {{ post.comments.count }}</span>
                    </div>
                    
                    {% if user == post.author %}
                    <div>
                        <a href="{% url 'edit_post' post.pk %}" class="btn btn-sm btn-outline-secondary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="{% url 'delete_post' post.pk %}" class="btn btn-sm btn-outline-danger">–£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ -->
        <div class="card mt-4">
            <div class="card-body">
                <h5 class="card-title">–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h5>
                
                {% if user.is_authenticated %}
                <form method="post" class="mb-4">
                    {% csrf_token %}
                    <div class="mb-3">
                        {{ form.content }}
                    </div>
                    <button type="submit" class="btn btn-primary">–î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
                </form>
                {% else %}
                <div class="alert alert-info">
                    <a href="{% url 'login' %}">–í–æ–π–¥–∏—Ç–µ</a>, —á—Ç–æ–±—ã –æ—Å—Ç–∞–≤–ª—è—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏.
                </div>
                {% endif %}
                
                {% for comment in comments %}
                <div class="border-bottom pb-3 mb-3">
                    <div class="d-flex justify-content-between">
                        <strong>
                            <a href="{% url 'profile' comment.user.username %}" class="text-decoration-none">
                                {{ comment.user.username }}
                            </a>
                        </strong>
                        <small class="text-muted">{{ comment.created_at|date:"d M Y H:i" }}</small>
                    </div>
                    <p class="mb-0 mt-1">{{ comment.content|linebreaksbr }}</p>
                </div>
                {% empty %}
                <p class="text-muted">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</p>
                {% endfor %}
            </div>
        </div>
        
        <div class="mt-3">
            <a href="{% url 'home' %}" class="btn btn-outline-secondary">‚Üê –ù–∞–∑–∞–¥ –∫ –ª–µ–Ω—Ç–µ</a>
        </div>
    </div>
</div>
{% endblock %}